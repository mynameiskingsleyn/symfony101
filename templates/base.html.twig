<!DOCTYPE html>
<html>
  <head>
      <meta charset="UTF-8">
      <title>{% block title %}Welcome!{% endblock %}</title>
      {% block stylesheets %}
          <link rel="stylesheet" href="{{ asset('build/css/app.css') }}">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      {% endblock %}
  </head>
  <body class="bg-light">
    {% include "includes/nav.html.twig" %}
    <main role="main" class="container">
        <div class="my-3 p-3 bg-white rounded box-shadow">

            {% block body %}
            {% endblock %}

        </div>

    </main>
    {% block javascripts %}
        <script src="{{ asset('build/js/app.js') }}"></script>
        <script>
          {% if app.user %}
            fetchNotificationCount();

          {% endif %}
          function fetchNotificationCount(){
            fetch(
              "{{ path('notification_unread')}}",
              {'credentials': 'include'}
            ).then(function(resp){
              resp.json().then(function(value){
                document.querySelector('#notification-count').innerText = value.count
              });
              setTimeout(fetchNotificationCount,10000);
            }).catch(function(err){
              console.log(err);
            });
          }
        </script>
    {% endblock %}
  </body>
</html>
